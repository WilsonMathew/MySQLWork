--------------
/* Wilson Mateo */

    /* enable warnings! */

use  a_bkorders
--------------

Query OK, 0 rows affected (0.01 sec)

--------------
/*  TASK 00 */ 
select user(), current_date(), version(), @@sql_mode
--------------

*************************** 1. row ***************************
        user(): WilsonMathew@localhost
current_date(): 2014-05-06
     version(): 5.6.16
    @@sql_mode: STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
1 row in set (0.00 sec)

--------------
/*  TASK 01 */
select 
	coalesce(order_date, "Total") as OrderDate
	, count(*) NumberOrders
	, sum(quantity * order_price) as AmntDue
	, sum(quantity) as NumbBooksPurch
from a_bkorders.order_headers OH
join a_bkorders.order_details OD using(order_id)
group by order_date with rollup
--------------

+------------+--------------+-----------+----------------+
| OrderDate  | NumberOrders | AmntDue   | NumbBooksPurch |
+------------+--------------+-----------+----------------+
| 2012-10-02 |            4 |   1363.49 |             53 |
| 2012-10-18 |            4 |    578.59 |             16 |
| 2012-10-23 |            2 |    859.50 |             20 |
| 2012-10-28 |            6 |  10307.45 |            262 |
| 2012-11-02 |            2 |    213.75 |              6 |
| 2012-11-04 |            3 |    287.75 |             14 |
| 2012-11-05 |            1 |     44.99 |              1 |
| 2012-11-09 |            3 |    100.49 |              3 |
| 2012-11-22 |            6 |    901.30 |             28 |
| 2012-11-25 |            3 |    649.95 |             15 |
| 2012-11-28 |            3 |    600.40 |             16 |
| 2012-11-29 |            4 |   2183.75 |             36 |
| 2012-11-30 |            2 |   5355.30 |            110 |
| 2012-12-03 |            8 |  29504.13 |            906 |
| 2012-12-04 |            2 |    285.40 |             13 |
| 2012-12-07 |            1 |    700.00 |             35 |
| 2012-12-23 |            2 |    859.50 |             20 |
| 2012-12-28 |            6 |  10307.45 |            262 |
| 2013-01-11 |            2 |    137.45 |              4 |
| 2013-01-12 |            7 |   3273.93 |            115 |
| 2013-01-18 |            3 |   2585.50 |             90 |
| 2013-01-25 |            2 |   1625.00 |            145 |
| 2013-01-26 |            1 |   2450.00 |             50 |
| 2013-01-27 |            2 |   6794.00 |            149 |
| 2013-02-02 |            1 |     58.00 |              1 |
| 2013-02-04 |            2 |   2454.26 |            454 |
| 2013-02-12 |            2 |   6900.00 |            300 |
| 2013-02-15 |            1 |    276.00 |             23 |
| 2013-02-16 |            1 |   3875.00 |            155 |
| 2013-02-18 |            3 |    564.95 |             12 |
| 2013-02-22 |            3 |    308.70 |              7 |
| 2013-02-28 |            4 |    299.70 |              8 |
| 2013-03-01 |            1 |     24.00 |              2 |
| 2013-03-02 |            2 |   1290.49 |             51 |
| 2013-03-06 |            1 |   1250.00 |             50 |
| 2013-03-10 |            2 |   1271.90 |             52 |
| 2013-03-12 |            1 |    499.50 |             10 |
| 2013-03-18 |            4 |    402.64 |             16 |
| 2013-03-20 |            2 |     56.34 |              2 |
| 2013-03-23 |            1 |   1000.00 |            500 |
| 2013-04-02 |            1 |   1250.00 |             50 |
| 2013-04-05 |            2 |   1300.00 |             30 |
| 2013-04-12 |            4 |    464.70 |             28 |
| 2013-04-13 |            2 |     50.90 |              3 |
| 2013-04-14 |            1 |   1250.00 |             50 |
| 2013-04-17 |            1 |     49.95 |              1 |
| 2013-04-18 |            3 |   4745.00 |            150 |
| 2013-04-21 |            1 |    181.96 |              4 |
| 2013-04-24 |            1 |    560.00 |             16 |
| 2013-05-08 |            1 |   4503.51 |             99 |
| 2013-05-09 |            2 |   3015.99 |            100 |
| 2013-05-12 |            4 |    198.85 |              7 |
| 2013-05-15 |            1 |     45.99 |              1 |
| 2013-05-16 |            4 |    750.98 |             34 |
| 2013-05-17 |            1 |    273.75 |             25 |
| 2013-05-20 |            1 |     25.00 |              2 |
| 2013-05-22 |            1 |     35.00 |              1 |
| 2013-05-30 |            1 |   1250.00 |             50 |
| 2013-06-08 |            5 |   1296.01 |             31 |
| 2013-06-12 |            5 |    148.94 |              5 |
| 2013-06-20 |            1 |     24.00 |              2 |
| 2013-06-21 |            1 |     25.00 |              2 |
| 2013-06-22 |            3 |   2525.00 |            102 |
| 2013-06-25 |            1 |   2525.00 |            100 |
| 2013-06-26 |            5 |    411.55 |             26 |
| 2013-06-28 |            2 |     46.78 |              4 |
| 2013-07-01 |            6 |   1301.25 |             43 |
| 2013-07-02 |            2 |   1290.49 |             51 |
| 2013-07-08 |           14 |   1114.43 |             46 |
| 2013-07-18 |            9 |   1419.89 |             41 |
| 2013-07-20 |            3 |     83.63 |              3 |
| 2013-08-01 |            2 |    177.97 |              3 |
| 2013-08-02 |            3 |   1479.72 |             34 |
| 2013-08-03 |            4 |  12930.75 |            391 |
| 2013-08-04 |            2 |     38.89 |              3 |
| 2013-08-05 |            2 |    928.49 |             51 |
| 2013-08-08 |            6 |   2689.01 |            112 |
| 2013-08-15 |            1 |     40.49 |              1 |
| 2013-09-01 |            1 |    165.00 |             11 |
| 2013-09-02 |            3 |   2107.45 |             45 |
| 2013-09-03 |            1 |   1250.00 |             50 |
| 2013-09-04 |            2 |   2749.50 |            100 |
| 2013-09-05 |            2 |    124.95 |              6 |
| 2013-09-06 |            2 |   1475.60 |             10 |
| 2013-09-08 |            3 |    806.00 |             28 |
| 2013-09-10 |            9 |   4308.40 |            154 |
| 2013-09-14 |            5 |    525.40 |             18 |
| 2013-09-15 |            4 |    297.19 |            102 |
| 2013-09-18 |            6 |   1455.24 |             48 |
| 2013-09-20 |            4 |    996.68 |             25 |
| 2013-09-22 |           10 |   2726.29 |             88 |
| 2013-09-23 |            2 |     59.99 |              2 |
| 2013-09-24 |            1 |     45.00 |              1 |
| 2013-09-25 |            3 |    649.95 |             15 |
| 2013-09-28 |            5 |  22220.38 |            578 |
| 2013-09-29 |            2 |   2500.00 |            100 |
| 2013-09-30 |           12 |   3325.26 |            114 |
| 2013-10-03 |            5 |   3150.80 |            106 |
| 2013-10-06 |           15 |  23016.30 |            555 |
| 2013-10-11 |            2 |    137.45 |              4 |
| 2013-11-02 |            2 |    213.75 |              6 |
| 2013-11-11 |            2 |    137.45 |              4 |
| 2013-11-28 |            3 |   9742.50 |            250 |
| 2013-11-29 |            2 |   2047.80 |             30 |
| 2013-11-30 |            2 |   5355.30 |            110 |
| 2013-12-02 |            1 |     58.00 |              1 |
| 2013-12-04 |            3 |    287.75 |             14 |
| 2013-12-11 |            2 |    137.45 |              4 |
| 2013-12-12 |            4 |    223.93 |              5 |
| 2014-01-18 |            3 |    564.95 |             12 |
| 2014-01-22 |            3 |    308.70 |              7 |
| 2014-01-25 |            2 |   1625.00 |            145 |
| 2014-01-26 |            1 |   2450.00 |             50 |
| 2014-01-28 |            4 |    299.70 |              8 |
| 2014-02-12 |            5 |    225.84 |              8 |
| 2014-02-15 |            5 |    452.23 |             28 |
| 2014-02-20 |            1 |     25.00 |              2 |
| 2014-03-01 |            1 |     24.00 |              2 |
| 2014-03-02 |            2 |   1290.49 |             51 |
| 2014-03-03 |            1 |   1250.00 |             50 |
| 2014-03-04 |            2 |    180.00 |              6 |
| 2014-03-08 |            5 |   1288.01 |             37 |
| 2014-03-12 |            8 |    398.32 |             10 |
| 2014-03-13 |            4 |    103.90 |              4 |
| 2014-03-20 |            2 |   6794.00 |            149 |
| 2014-03-21 |            2 |    519.50 |             20 |
| 2014-03-22 |            2 |    394.95 |              6 |
| 2014-03-23 |            5 |   1593.00 |            409 |
| 2014-03-24 |            2 |     61.89 |              3 |
| 2014-03-25 |            1 |    180.00 |              2 |
| 2014-03-26 |            3 |     55.95 |              3 |
| 2014-04-02 |            2 |    999.00 |             30 |
| 2014-04-05 |            1 |     40.49 |              1 |
| 2014-04-08 |            2 |     69.00 |              3 |
| 2014-04-15 |            1 |     40.49 |              1 |
| 2014-05-01 |            1 |    165.00 |             11 |
| 2014-05-02 |            3 |   2107.45 |             45 |
| 2014-05-04 |            2 |   2749.50 |            100 |
| 2014-05-05 |            2 |     64.95 |              2 |
| 2014-05-06 |            2 |   1295.60 |              8 |
| 2014-05-24 |            1 |     75.00 |              5 |
| 2014-05-26 |            2 |   1475.60 |             10 |
| Total      |          422 | 274413.69 |           9526 |
+------------+--------------+-----------+----------------+
143 rows in set (0.02 sec)

--------------
/*  TASK 02 format 2 */
select 
	coalesce(tbl.order_year, 'Grand Total') as "Year"
	, case 
			when order_year is null then 
			'..........'
			else 
			coalesce(tbl.order_month, 'Yearly Total') 
	  end as "Month"
	, case 
			when order_month is null then  
			'..........'
			else 
			coalesce(tbl.id,'Month Total')
	  end as "Order_ID" 
	, tbl.amount_due as "AmntDue"
	, tbl.books_purchased  as "NumbBooksPurch"
from 
(
	select 
		year(order_date) as "order_year"
		, month(order_date) as "order_month"
		, OH.order_id as "id"
		, sum(quantity * order_price) as "amount_due"
		, sum(quantity) as "books_purchased"
	from a_bkorders.order_headers OH
	join a_bkorders.order_details OD on OH.order_id = OD.order_id
	group by year(order_date), month(order_date), id with rollup
)tbl
--------------

+-------------+--------------+-------------+-----------+----------------+
| Year        | Month        | Order_ID    | AmntDue   | NumbBooksPurch |
+-------------+--------------+-------------+-----------+----------------+
| 2012        | 10           | 1254        |    859.50 |             20 |
| 2012        | 10           | 1255        |    564.95 |             12 |
| 2012        | 10           | 1261        |   9742.50 |            250 |
| 2012        | 10           | 2045        |     35.99 |              1 |
| 2012        | 10           | 2200        |    542.60 |             15 |
| 2012        | 10           | 21841       |   1250.00 |             50 |
| 2012        | 10           | 21850       |     55.49 |              2 |
| 2012        | 10           | 32905       |     58.00 |              1 |
| 2012        | 10           | Month Total |  13109.03 |            351 |
| 2012        | 11           | 1262        |    213.75 |              6 |
| 2012        | 11           | 1302        |     44.99 |              1 |
| 2012        | 11           | 1310        |    100.49 |              3 |
| 2012        | 11           | 1321        |   2047.80 |             30 |
| 2012        | 11           | 1328        |   3149.30 |             70 |
| 2012        | 11           | 1345        |   2206.00 |             40 |
| 2012        | 11           | 22909       |    225.00 |              5 |
| 2012        | 11           | 22910       |    424.95 |             10 |
| 2012        | 11           | 32906       |    287.75 |             14 |
| 2012        | 11           | 32997       |    841.30 |             25 |
| 2012        | 11           | 32998       |     60.00 |              3 |
| 2012        | 11           | 41005       |    170.90 |              6 |
| 2012        | 11           | 41006       |    429.50 |             10 |
| 2012        | 11           | 42899       |    135.95 |              6 |
| 2012        | 11           | Month Total |  10337.68 |            229 |
| 2012        | 12           | 1346        |  29267.00 |            900 |
| 2012        | 12           | 1347        |    237.13 |              6 |
| 2012        | 12           | 1410        |    700.00 |             35 |
| 2012        | 12           | 21254       |    859.50 |             20 |
| 2012        | 12           | 21255       |    564.95 |             12 |
| 2012        | 12           | 21261       |   9742.50 |            250 |
| 2012        | 12           | 32907       |    285.40 |             13 |
| 2012        | 12           | Month Total |  41656.48 |           1236 |
| 2012        | Yearly Total | ..........  |  65103.19 |           1816 |
| 2013        | 1            | 1411        |   1250.00 |             50 |
| 2013        | 1            | 1420        |   1800.00 |             60 |
| 2013        | 1            | 1442        |   2585.50 |             90 |
| 2013        | 1            | 1483        |    137.45 |              4 |
| 2013        | 1            | 1491        |    123.95 |              3 |
| 2013        | 1            | 1552        |     99.98 |              2 |
| 2013        | 1            | 32900       |   1625.00 |            145 |
| 2013        | 1            | 32901       |   2450.00 |             50 |
| 2013        | 1            | 32902       |   6794.00 |            149 |
| 2013        | 1            | Month Total |  16865.88 |            553 |
| 2013        | 2            | 1553        |   6900.00 |            300 |
| 2013        | 2            | 1555        |    564.95 |             12 |
| 2013        | 2            | 1561        |    308.70 |              7 |
| 2013        | 2            | 1562        |    299.70 |              8 |
| 2013        | 2            | 30814       |    276.00 |             23 |
| 2013        | 2            | 30815       |   3875.00 |            155 |
| 2013        | 2            | 32903       |     58.00 |              1 |
| 2013        | 2            | 32904       |   2454.26 |            454 |
| 2013        | 2            | Month Total |  14736.61 |            960 |
| 2013        | 3            | 30816       |   1250.00 |             50 |
| 2013        | 3            | 30820       |   1250.00 |             50 |
| 2013        | 3            | 30821       |     21.90 |              2 |
| 2013        | 3            | 30822       |    499.50 |             10 |
| 2013        | 3            | 30855       |   1000.00 |            500 |
| 2013        | 3            | 51840       |     24.00 |              2 |
| 2013        | 3            | 51841       |   1290.49 |             51 |
| 2013        | 3            | 51842       |    402.64 |             16 |
| 2013        | 3            | 51843       |     56.34 |              2 |
| 2013        | 3            | Month Total |   5794.87 |            683 |
| 2013        | 4            | 1564        |   4745.00 |            150 |
| 2013        | 4            | 1800        |    221.70 |              6 |
| 2013        | 4            | 1801        |     50.90 |              3 |
| 2013        | 4            | 2001        |   1250.00 |             50 |
| 2013        | 4            | 2002        |    219.00 |             20 |
| 2013        | 4            | 2003        |     24.00 |              2 |
| 2013        | 4            | 30824       |   1300.00 |             30 |
| 2013        | 4            | 30825       |    181.96 |              4 |
| 2013        | 4            | 30826       |    560.00 |             16 |
| 2013        | 4            | 30833       |   1250.00 |             50 |
| 2013        | 4            | 30834       |     49.95 |              1 |
| 2013        | 4            | Month Total |   9852.51 |            332 |
| 2013        | 5            | 1710        |   4503.51 |             99 |
| 2013        | 5            | 1712        |   3015.99 |            100 |
| 2013        | 5            | 1811        |    171.86 |              6 |
| 2013        | 5            | 1812        |     26.99 |              1 |
| 2013        | 5            | 1814        |     45.99 |              1 |
| 2013        | 5            | 1818        |    750.98 |             34 |
| 2013        | 5            | 2004        |     35.00 |              1 |
| 2013        | 5            | 2005        |   1250.00 |             50 |
| 2013        | 5            | 30835       |    273.75 |             25 |
| 2013        | 5            | 30836       |     25.00 |              2 |
| 2013        | 5            | Month Total |  10099.07 |            319 |
| 2013        | 6            | 2012        |   1250.00 |             50 |
| 2013        | 6            | 2013        |     25.00 |              2 |
| 2013        | 6            | 30847       |     24.00 |              2 |
| 2013        | 6            | 30848       |     25.00 |              2 |
| 2013        | 6            | 30849       |   1250.00 |             50 |
| 2013        | 6            | 51833       |   1226.01 |             30 |
| 2013        | 6            | 51850       |     70.00 |              1 |
| 2013        | 6            | 51851       |    148.94 |              3 |
| 2013        | 6            | 51852       |      0.00 |              2 |
| 2013        | 6            | 51853       |   2525.00 |            100 |
| 2013        | 6            | 51854       |    230.55 |             15 |
| 2013        | 6            | 51855       |    181.00 |             11 |
| 2013        | 6            | 51856       |     46.78 |              4 |
| 2013        | 6            | Month Total |   7002.28 |            272 |
| 2013        | 7            | 1045        |     35.99 |              1 |
| 2013        | 7            | 1200        |   1383.90 |             40 |
| 2013        | 7            | 1205        |     27.29 |              1 |
| 2013        | 7            | 1212        |     56.34 |              2 |
| 2013        | 7            | 31840       |     24.00 |              2 |
| 2013        | 7            | 31841       |   1250.00 |             50 |
| 2013        | 7            | 31850       |     40.49 |              1 |
| 2013        | 7            | 51845       |   1277.25 |             41 |
| 2013        | 7            | 51846       |    642.68 |             32 |
| 2013        | 7            | 51857       |    185.12 |              5 |
| 2013        | 7            | 51858       |    116.70 |              6 |
| 2013        | 7            | 51859       |    113.94 |              2 |
| 2013        | 7            | 51860       |     55.99 |              1 |
| 2013        | 7            | Month Total |   5209.69 |            184 |
| 2013        | 8            | 1224        |    441.52 |              8 |
| 2013        | 8            | 1253        |     69.00 |              3 |
| 2013        | 8            | 31852       |     40.49 |              1 |
| 2013        | 8            | 31853       |    999.00 |             30 |
| 2013        | 8            | 31855       |     40.49 |              1 |
| 2013        | 8            | 31860       |     40.49 |              1 |
| 2013        | 8            | 51847       |     38.89 |              3 |
| 2013        | 8            | 51848       |    888.00 |             50 |
| 2013        | 8            | 51849       |   2138.00 |            100 |
| 2013        | 8            | 51861       |    177.97 |              3 |
| 2013        | 8            | 51862       |    480.72 |              4 |
| 2013        | 8            | 51863       |    837.90 |             42 |
| 2013        | 8            | 51864       |  12092.85 |            349 |
| 2013        | 8            | Month Total |  18285.32 |            595 |
| 2013        | 9            | 1002        |    581.00 |             23 |
| 2013        | 9            | 1003        |    225.00 |              5 |
| 2013        | 9            | 1004        |     36.50 |              2 |
| 2013        | 9            | 1005        |    170.90 |              6 |
| 2013        | 9            | 1006        |    109.50 |             10 |
| 2013        | 9            | 1007        |   1250.00 |             50 |
| 2013        | 9            | 1008        |   2000.00 |             50 |
| 2013        | 9            | 1010        |   1250.00 |             50 |
| 2013        | 9            | 1011        |     21.90 |              2 |
| 2013        | 9            | 1012        |     49.95 |              1 |
| 2013        | 9            | 1027        |   1291.57 |             43 |
| 2013        | 9            | 1028        |    996.68 |             25 |
| 2013        | 9            | 1030        |     40.49 |              1 |
| 2013        | 9            | 1035        |     55.19 |              1 |
| 2013        | 9            | 1039        |     99.90 |              3 |
| 2013        | 9            | 1040        |  21939.98 |            562 |
| 2013        | 9            | 1602        |     50.90 |              3 |
| 2013        | 9            | 1603        |    252.75 |              7 |
| 2013        | 9            | 1604        |    708.75 |             40 |
| 2013        | 9            | 1606        |    474.50 |             15 |
| 2013        | 9            | 1610        |     24.00 |              2 |
| 2013        | 9            | 1615        |     24.00 |              2 |
| 2013        | 9            | 1661        |    194.00 |             97 |
| 2013        | 9            | 22803       |   2107.45 |             45 |
| 2013        | 9            | 22804       |   2749.50 |            100 |
| 2013        | 9            | 22805       |   1475.60 |             10 |
| 2013        | 9            | 22806       |     25.00 |              1 |
| 2013        | 9            | 22807       |     34.99 |              1 |
| 2013        | 9            | 22808       |     45.00 |              1 |
| 2013        | 9            | 22809       |    225.00 |              5 |
| 2013        | 9            | 22810       |    424.95 |             10 |
| 2013        | 9            | 22811       |    225.00 |              5 |
| 2013        | 9            | 22812       |   2704.50 |            100 |
| 2013        | 9            | 22813       |    395.76 |              9 |
| 2013        | 9            | 31884       |    209.91 |             10 |
| 2013        | 9            | 31885       |   1250.00 |             50 |
| 2013        | 9            | 31889       |    910.80 |             18 |
| 2013        | 9            | 32800       |   1250.00 |             50 |
| 2013        | 9            | 32890       |    165.00 |             11 |
| 2013        | 9            | 32891       |     75.00 |              5 |
| 2013        | 9            | 32892       |     75.00 |              5 |
| 2013        | 9            | 32893       |     55.19 |              1 |
| 2013        | 9            | 32894       |     35.99 |              1 |
| 2013        | 9            | 32895       |     55.19 |              1 |
| 2013        | 9            | 32896       |     35.99 |              1 |
| 2013        | 9            | 32897       |    100.00 |              2 |
| 2013        | 9            | 32898       |     60.00 |              3 |
| 2013        | 9            | 32899       |   1250.00 |             50 |
| 2013        | 9            | Month Total |  47788.28 |           1495 |
| 2013        | 10           | 1563        |     50.90 |              3 |
| 2013        | 10           | 1601        |    800.30 |             21 |
| 2013        | 10           | 1605        |   1057.00 |             32 |
| 2013        | 10           | 1702        |    100.00 |              2 |
| 2013        | 10           | 1705        |  21059.00 |            500 |
| 2013        | 10           | 14873       |    137.45 |              4 |
| 2013        | 10           | 31871       |     99.90 |              3 |
| 2013        | 10           | 31872       |   3000.00 |            100 |
| 2013        | 10           | Month Total |  26304.55 |            665 |
| 2013        | 11           | 5261        |   9742.50 |            250 |
| 2013        | 11           | 5262        |    213.75 |              6 |
| 2013        | 11           | 5321        |   2047.80 |             30 |
| 2013        | 11           | 5328        |   3149.30 |             70 |
| 2013        | 11           | 5345        |   2206.00 |             40 |
| 2013        | 11           | 54883       |    137.45 |              4 |
| 2013        | 11           | Month Total |  17496.80 |            400 |
| 2013        | 12           | 5483        |    137.45 |              4 |
| 2013        | 12           | 5491        |    123.95 |              3 |
| 2013        | 12           | 5552        |     99.98 |              2 |
| 2013        | 12           | 52905       |     58.00 |              1 |
| 2013        | 12           | 52906       |    287.75 |             14 |
| 2013        | 12           | Month Total |    707.13 |             24 |
| 2013        | Yearly Total | ..........  | 180142.99 |           6482 |
| 2014        | 1            | 5555        |    564.95 |             12 |
| 2014        | 1            | 5561        |    308.70 |              7 |
| 2014        | 1            | 5562        |    299.70 |              8 |
| 2014        | 1            | 52900       |   1625.00 |            145 |
| 2014        | 1            | 52901       |   2450.00 |             50 |
| 2014        | 1            | Month Total |   5248.35 |            222 |
| 2014        | 2            | 18142       |     26.99 |              1 |
| 2014        | 2            | 18144       |     45.99 |              1 |
| 2014        | 2            | 18145       |     84.25 |              3 |
| 2014        | 2            | 40814       |    276.00 |             23 |
| 2014        | 2            | 40836       |     25.00 |              2 |
| 2014        | 2            | 41811       |    171.86 |              6 |
| 2014        | 2            | 41812       |     26.99 |              1 |
| 2014        | 2            | 41814       |     45.99 |              1 |
| 2014        | 2            | Month Total |    703.07 |             38 |
| 2014        | 3            | 4002        |    581.00 |             23 |
| 2014        | 3            | 4003        |    225.00 |              5 |
| 2014        | 3            | 4007        |   1250.00 |             50 |
| 2014        | 3            | 33001       |    180.00 |              6 |
| 2014        | 3            | 33002       |    237.13 |              6 |
| 2014        | 3            | 33005       |     51.95 |              2 |
| 2014        | 3            | 33006       |     51.95 |              2 |
| 2014        | 3            | 33007       |    161.19 |              4 |
| 2014        | 3            | 33008       |    189.00 |              7 |
| 2014        | 3            | 33009       |    195.00 |              5 |
| 2014        | 3            | 33013       |   6794.00 |            149 |
| 2014        | 3            | 33014       |    519.50 |             20 |
| 2014        | 3            | 33017       |      4.00 |              1 |
| 2014        | 3            | 33022       |    199.95 |              1 |
| 2014        | 3            | 33023       |    460.00 |              5 |
| 2014        | 3            | 33025       |    944.00 |            397 |
| 2014        | 3            | 33034       |     61.89 |              3 |
| 2014        | 3            | 33035       |    180.00 |              2 |
| 2014        | 3            | 33040       |     51.95 |              2 |
| 2014        | 3            | 41224       |    441.52 |              8 |
| 2014        | 3            | 41840       |     24.00 |              2 |
| 2014        | 3            | 41841       |   1250.00 |             50 |
| 2014        | 3            | 41850       |     40.49 |              1 |
| 2014        | 3            | 41852       |     40.49 |              1 |
| 2014        | 3            | Month Total |  14134.01 |            752 |
| 2014        | 4            | 1256        |     69.00 |              3 |
| 2014        | 4            | 31455       |     40.49 |              1 |
| 2014        | 4            | 31560       |     40.49 |              1 |
| 2014        | 4            | 41853       |    999.00 |             30 |
| 2014        | 4            | Month Total |   1148.98 |             35 |
| 2014        | 5            | 10812       |     49.95 |              1 |
| 2014        | 5            | 22774       |   2749.50 |            100 |
| 2014        | 5            | 23890       |    165.00 |             11 |
| 2014        | 5            | 24345       |   1475.60 |             10 |
| 2014        | 5            | 24802       |   1295.60 |              8 |
| 2014        | 5            | 25803       |   2107.45 |             45 |
| 2014        | 5            | 42331       |     75.00 |              5 |
| 2014        | 5            | 42891       |     15.00 |              1 |
| 2014        | 5            | Month Total |   7933.10 |            181 |
| 2014        | Yearly Total | ..........  |  29167.51 |           1228 |
| Grand Total | ..........   | ..........  | 274413.69 |           9526 |
+-------------+--------------+-------------+-----------+----------------+
255 rows in set (0.03 sec)

--------------
/*  TASK 03 */
select 
	coalesce(tbl.order_year, 'Grand Total') as ""
	, coalesce(tbl.order_month, 'Yearly Total') as ""
	, tbl.NumberOrders
	, tbl.amount_due as "AmntDue"
	, tbl.books_purchased  as "NumbBooksPurch"
from 
(
	select 
		year(order_date) as "order_year"
		, month(order_date) as "order_month"
		, count(OH.order_id) as "NumberOrders"
		, sum(quantity * order_price) as "amount_due"
		, sum(quantity) as "books_purchased"
	from a_bkorders.order_headers OH
	join a_bkorders.order_details OD on OH.order_id = OD.order_id
	group by year(order_date), month(order_date) with rollup
)tbl
where order_month is null
or order_year is null
--------------

+-------------+--------------+--------------+-----------+----------------+
|             |              | NumberOrders | AmntDue   | NumbBooksPurch |
+-------------+--------------+--------------+-----------+----------------+
| 2012        | Yearly Total |           62 |  65103.19 |           1816 |
| 2013        | Yearly Total |          277 | 180142.99 |           6482 |
| 2014        | Yearly Total |           83 |  29167.51 |           1228 |
| Grand Total | Yearly Total |          422 | 274413.69 |           9526 |
+-------------+--------------+--------------+-----------+----------------+
4 rows in set (0.01 sec)

--------------
/*  TASK 04 */
select
	coalesce(author_id, 'ALL Authors') as AuthorID
	, coalesce(B.book_id, 'All books') as BookID
	, coalesce(sum(quantity), 0) as TotalQuantity
	, coalesce(sum(quantity * order_price),'No sales') as TotalSales
from a_bkinfo.authors A
join a_bkinfo.book_authors BA using(author_id)
join a_bkinfo.books B using (book_id)
left join a_bkorders.order_details OD on B.book_id = OD.book_id
where author_sequence = 1
group by author_id, B.book_id with rollup
--------------

+-------------+-----------+---------------+------------+
| AuthorID    | BookID    | TotalQuantity | TotalSales |
+-------------+-----------+---------------+------------+
| A0110       | 1142      |           364 | 12585.60   |
| A0110       | All books |           364 | 12585.60   |
| A5748       | 1278      |             1 | 48.00      |
| A5748       | All books |             1 | 48.00      |
| B1112       | 2006      |            42 | 866.95     |
| B1112       | 2007      |            53 | 1916.98    |
| B1112       | All books |            95 | 2783.93    |
| B1144       | 1622      |             0 | No sales   |
| B1144       | All books |             0 | No sales   |
| B1244       | 1623      |             0 | No sales   |
| B1244       | All books |             0 | No sales   |
| B2010       | 1102      |             4 | 199.96     |
| B2010       | 1689      |            13 | 717.47     |
| B2010       | All books |            17 | 917.43     |
| B2078       | 2005      |            20 | 900.00     |
| B2078       | All books |            20 | 900.00     |
| C0030       | 1106      |           134 | 3867.50    |
| C0030       | 1107      |           103 | 2301.50    |
| C0030       | 1161      |           164 | 4765.00    |
| C0030       | 1162      |           190 | 6134.09    |
| C0030       | All books |           591 | 17068.09   |
| C0844       | 1401      |           541 | 29966.00   |
| C0844       | All books |           541 | 29966.00   |
| C5820       | 1478      |             5 | 225.00     |
| C5820       | All books |             5 | 225.00     |
| C8794       | 1948      |            12 | 491.28     |
| C8794       | All books |            12 | 491.28     |
| D0030       | 1109      |            53 | 1840.80    |
| D0030       | 1128      |           819 | 31909.34   |
| D0030       | All books |           872 | 33750.14   |
| D2110       | 1301      |            45 | 2047.50    |
| D2110       | 1304      |           116 | 5445.84    |
| D2110       | All books |           161 | 7493.34    |
| D3040       | 1101      |            49 | 2804.11    |
| D3040       | All books |            49 | 2804.11    |
| D6290       | 2025      |           560 | 21840.00   |
| D6290       | All books |           560 | 21840.00   |
| D8902       | 1182      |           142 | 6388.60    |
| D8902       | All books |           142 | 6388.60    |
| D8956       | 1175      |             3 | 114.89     |
| D8956       | 1184      |             1 | 49.99      |
| D8956       | All books |             4 | 164.88     |
| G4040       | 2009      |            40 | 1332.22    |
| G4040       | All books |            40 | 1332.22    |
| G4748       | 1537      |            73 | 1699.69    |
| G4748       | All books |            73 | 1699.69    |
| G5050       | 1200      |            21 | 344.30     |
| G5050       | 1234      |             0 | No sales   |
| G5050       | 1774      |             1 | 14.67      |
| G5050       | All books |            22 | 358.97     |
| G8495       | 1545      |             7 | 95.80      |
| G8495       | All books |             7 | 95.80      |
| H0187       | 1457      |            10 | 539.90     |
| H0187       | All books |            10 | 539.90     |
| H0202       | 1185      |             1 | 49.99      |
| H0202       | All books |             1 | 49.99      |
| H2987       | 2001      |           396 | 15655.57   |
| H2987       | All books |           396 | 15655.57   |
| H3145       | 1627      |             5 | 680.67     |
| H3145       | 1628      |            21 | 690.55     |
| H3145       | 1629      |            54 | 1077.30    |
| H3145       | All books |            80 | 2448.52    |
| I5110       | 2031      |             0 | No sales   |
| I5110       | 2032      |             5 | 233.96     |
| I5110       | All books |             5 | 233.96     |
| J8845       | 1541      |             9 | 105.90     |
| J8845       | 1542      |             1 | 16.99      |
| J8845       | All books |            10 | 122.89     |
| K7620       | 1425      |            53 | 1486.58    |
| K7620       | 1448      |           992 | 25441.00   |
| K7620       | 1978      |            25 | 2372.00    |
| K7620       | All books |          1070 | 29299.58   |
| L0140       | 1108      |           942 | 28410.30   |
| L0140       | All books |           942 | 28410.30   |
| L0245       | 1894      |            24 | 844.48     |
| L0245       | All books |            24 | 844.48     |
| L0453       | 1188      |             1 | 49.99      |
| L0453       | All books |             1 | 49.99      |
| M0024       | 1609      |             4 | 75.80      |
| M0024       | All books |             4 | 75.80      |
| M0053       | 1105      |            80 | 4412.00    |
| M0053       | 1110      |             4 | 200.00     |
| M0053       | 1269      |             3 | 186.73     |
| M0053       | All books |            87 | 4798.73    |
| M0157       | 1678      |            10 | 499.90     |
| M0157       | All books |            10 | 499.90     |
| M0295       | 1543      |            50 | 1250.00    |
| M0295       | 1544      |           100 | 1776.00    |
| M0295       | All books |           150 | 3026.00    |
| M2475       | 1624      |             0 | No sales   |
| M2475       | All books |             0 | No sales   |
| M3110       | 1302      |             0 | No sales   |
| M3110       | 1303      |             0 | No sales   |
| M3110       | All books |             0 | No sales   |
| M3145       | 1626      |             1 | 19.95      |
| M3145       | All books |             1 | 19.95      |
| M3200       | 1546      |            14 | 145.46     |
| M3200       | All books |            14 | 145.46     |
| M4540       | 2622      |             0 | No sales   |
| M4540       | 2623      |             0 | No sales   |
| M4540       | All books |             0 | No sales   |
| N6457       | 1835      |             1 | 45.99      |
| N6457       | All books |             1 | 45.99      |
| O0345       | 2003      |             0 | No sales   |
| O0345       | All books |             0 | No sales   |
| P0500       | 1279      |            12 | 472.38     |
| P0500       | All books |            12 | 472.38     |
| P2308       | 2002      |            27 | 955.00     |
| P2308       | All books |            27 | 955.00     |
| P6030       | 2018      |             2 | 99.98      |
| P6030       | All books |             2 | 99.98      |
| P7477       | 1525      |             0 | No sales   |
| P7477       | All books |             0 | No sales   |
| R2040       | 1670      |            60 | 2400.00    |
| R2040       | All books |            60 | 2400.00    |
| R5808       | 1602      |           898 | 1946.75    |
| R5808       | All books |           898 | 1946.75    |
| R5858       | 1357      |            54 | 1393.60    |
| R5858       | All books |            54 | 1393.60    |
| S0025       | 1104      |           133 | 5985.00    |
| S0025       | All books |           133 | 5985.00    |
| S0205       | 2008      |           108 | 4750.45    |
| S0205       | All books |           108 | 4750.45    |
| S1164       | 1180      |            12 | 556.88     |
| S1164       | All books |            12 | 556.88     |
| S1900       | 1877      |             1 | 45.00      |
| S1900       | All books |             1 | 45.00      |
| S2548       | 1677      |             1 | 70.00      |
| S2548       | All books |             1 | 70.00      |
| S2789       | 2004      |             1 | 49.95      |
| S2789       | All books |             1 | 49.95      |
| S3110       | 1305      |           898 | 5172.50    |
| S3110       | 1306      |            15 | 3751.80    |
| S3110       | All books |           913 | 8924.30    |
| T6789       | 1979      |             1 | 53.99      |
| T6789       | All books |             1 | 53.99      |
| V1144       | 1621      |             0 | No sales   |
| V1144       | All books |             0 | No sales   |
| W0030       | 1133      |            18 | 332.10     |
| W0030       | All books |            18 | 332.10     |
| W0078       | 1258      |             6 | 271.94     |
| W0078       | All books |             6 | 271.94     |
| W3145       | 1630      |             0 | No sales   |
| W3145       | All books |             0 | No sales   |
| W3433       | 1619      |           110 | 2997.88    |
| W3433       | All books |           110 | 2997.88    |
| W4512       | 2027      |             0 | No sales   |
| W4512       | All books |             0 | No sales   |
| W5145       | 1625      |             1 | 4.00       |
| W5145       | All books |             1 | 4.00       |
| ALL Authors | All books |          8740 | 258489.29  |
+-------------+-----------+---------------+------------+
151 rows in set (0.02 sec)

--------------
/*  TASK 05 */

select 
case 
	when OD.book_id is not null then
		coalesce(author_id,'_anon')
		else 
		coalesce(author_id,'Grand Total')
	end as AuthorID
, case 
	when sum(quantity) is null then 
		'No books'
		else
			coalesce(OD.book_id, 'All books')
	end as book_id
, coalesce(sum(quantity), 0) as TotalQuantity
, coalesce(sum(quantity * order_price),'No sales') as TotalSales
from 
(
	select 
	atbl1.author_id
	, B.book_id
	from
		(
			select
			 author_id
			 ,book_id
			from a_bkinfo.book_authors BA
			union all
			select 
			author_id
			, null
			from a_bkinfo.authors A
		) as atbl1
		right join a_bkinfo.books B on atbl1.book_id = B.book_id
union all
	select 
	atbl2.author_id
	, B.book_id
	from 
		(
			select
			 author_id
			 ,book_id
			from a_bkinfo.book_authors BA
			union all
			select 
			author_id
			, null
			from a_bkinfo.authors A
		) as atbl2
		left join a_bkinfo.books B on atbl2.book_id = B.book_id
) as authors_no
left join a_bkorders.order_details OD on authors_no.book_id = OD.book_id
group by author_id, OD.book_id with rollup
--------------

+-------------+-----------+---------------+------------+
| AuthorID    | book_id   | TotalQuantity | TotalSales |
+-------------+-----------+---------------+------------+
| Grand Total | No books  |             0 | No sales   |
| _anon       | 1077      |            24 | 323.28     |
| _anon       | 1103      |           519 | 5313.95    |
| _anon       | 1199      |            24 | 437.76     |
| _anon       | 1483      |             5 | 90.95      |
| _anon       | 1776      |           203 | 9184.47    |
| _anon       | 2017      |             2 | 49.99      |
| _anon       | 2028      |             9 | 524.00     |
| Grand Total | All books |           786 | 15924.40   |
| A0094       | No books  |             0 | No sales   |
| A0094       | 1948      |            24 | 982.56     |
| A0094       | All books |            24 | 982.56     |
| A0110       | No books  |             0 | No sales   |
| A0110       | 1142      |           728 | 25171.20   |
| A0110       | All books |           728 | 25171.20   |
| A5748       | No books  |             0 | No sales   |
| A5748       | 1278      |             2 | 96.00      |
| A5748       | All books |             2 | 96.00      |
| A7745       | No books  |             0 | No sales   |
| A7745       | 1609      |             8 | 151.60     |
| A7745       | All books |             8 | 151.60     |
| B0056       | No books  |             0 | No sales   |
| B0056       | 1877      |             2 | 90.00      |
| B0056       | All books |             2 | 90.00      |
| B1112       | No books  |             0 | No sales   |
| B1112       | 2006      |            84 | 1733.90    |
| B1112       | 2007      |           106 | 3833.96    |
| B1112       | All books |           190 | 5567.86    |
| B1144       | No books  |             0 | No sales   |
| B1144       | No books  |             0 | No sales   |
| B1244       | No books  |             0 | No sales   |
| B1244       | No books  |             0 | No sales   |
| B2010       | No books  |             0 | No sales   |
| B2010       | 1102      |             8 | 399.92     |
| B2010       | 1670      |           120 | 4800.00    |
| B2010       | 1689      |            26 | 1434.94    |
| B2010       | All books |           154 | 6634.86    |
| B2078       | No books  |             0 | No sales   |
| B2078       | 2005      |            40 | 1800.00    |
| B2078       | All books |            40 | 1800.00    |
| C0030       | No books  |             0 | No sales   |
| C0030       | 1106      |           268 | 7735.00    |
| C0030       | 1107      |           206 | 4603.00    |
| C0030       | 1161      |           328 | 9530.00    |
| C0030       | 1162      |           380 | 12268.18   |
| C0030       | All books |          1182 | 34136.18   |
| C0844       | No books  |             0 | No sales   |
| C0844       | 1401      |          1082 | 59932.00   |
| C0844       | All books |          1082 | 59932.00   |
| C5820       | No books  |             0 | No sales   |
| C5820       | 1478      |            10 | 450.00     |
| C5820       | All books |            10 | 450.00     |
| C8794       | No books  |             0 | No sales   |
| C8794       | 1948      |            24 | 982.56     |
| C8794       | All books |            24 | 982.56     |
| D0030       | No books  |             0 | No sales   |
| D0030       | 1109      |           106 | 3681.60    |
| D0030       | 1128      |          1638 | 63818.68   |
| D0030       | All books |          1744 | 67500.28   |
| D0050       | No books  |             0 | No sales   |
| D0050       | 1142      |           728 | 25171.20   |
| D0050       | All books |           728 | 25171.20   |
| D0070       | No books  |             0 | No sales   |
| D0070       | No books  |             0 | No sales   |
| D0845       | No books  |             0 | No sales   |
| D0845       | 2009      |            80 | 2664.44    |
| D0845       | All books |            80 | 2664.44    |
| D2110       | No books  |             0 | No sales   |
| D2110       | 1301      |            90 | 4095.00    |
| D2110       | 1304      |           232 | 10891.68   |
| D2110       | All books |           322 | 14986.68   |
| D2340       | No books  |             0 | No sales   |
| D2340       | 1128      |          1638 | 63818.68   |
| D2340       | All books |          1638 | 63818.68   |
| D3040       | No books  |             0 | No sales   |
| D3040       | 1101      |            98 | 5608.22    |
| D3040       | All books |            98 | 5608.22    |
| D6290       | No books  |             0 | No sales   |
| D6290       | 2025      |          1120 | 43680.00   |
| D6290       | All books |          1120 | 43680.00   |
| D8902       | No books  |             0 | No sales   |
| D8902       | 1182      |           284 | 12777.20   |
| D8902       | All books |           284 | 12777.20   |
| D8956       | No books  |             0 | No sales   |
| D8956       | 1175      |             6 | 229.78     |
| D8956       | 1184      |             2 | 99.98      |
| D8956       | All books |             8 | 329.76     |
| F2987       | No books  |             0 | No sales   |
| F2987       | 1185      |             2 | 99.98      |
| F2987       | All books |             2 | 99.98      |
| G4040       | No books  |             0 | No sales   |
| G4040       | 2009      |            80 | 2664.44    |
| G4040       | All books |            80 | 2664.44    |
| G4748       | No books  |             0 | No sales   |
| G4748       | 1537      |           146 | 3399.38    |
| G4748       | All books |           146 | 3399.38    |
| G5050       | No books  |             0 | No sales   |
| G5050       | 1200      |            42 | 688.60     |
| G5050       | 1774      |             2 | 29.34      |
| G5050       | All books |            44 | 717.94     |
| G8495       | No books  |             0 | No sales   |
| G8495       | 1545      |            14 | 191.60     |
| G8495       | All books |            14 | 191.60     |
| H0070       | No books  |             0 | No sales   |
| H0070       | No books  |             0 | No sales   |
| H0187       | No books  |             0 | No sales   |
| H0187       | 1457      |            20 | 1079.80    |
| H0187       | All books |            20 | 1079.80    |
| H0202       | No books  |             0 | No sales   |
| H0202       | 1185      |             2 | 99.98      |
| H0202       | All books |             2 | 99.98      |
| H2987       | No books  |             0 | No sales   |
| H2987       | 2001      |           792 | 31311.14   |
| H2987       | All books |           792 | 31311.14   |
| H3145       | No books  |             0 | No sales   |
| H3145       | 1627      |            10 | 1361.34    |
| H3145       | 1628      |            42 | 1381.10    |
| H3145       | 1629      |           108 | 2154.60    |
| H3145       | All books |           160 | 4897.04    |
| H8972       | No books  |             0 | No sales   |
| H8972       | 1278      |             2 | 96.00      |
| H8972       | All books |             2 | 96.00      |
| I0010       | No books  |             0 | No sales   |
| I0010       | 1109      |           106 | 3681.60    |
| I0010       | All books |           106 | 3681.60    |
| I5110       | No books  |             0 | No sales   |
| I5110       | 2032      |            10 | 467.92     |
| I5110       | All books |            10 | 467.92     |
| J6700       | No books  |             0 | No sales   |
| J6700       | 1457      |            20 | 1079.80    |
| J6700       | All books |            20 | 1079.80    |
| J8845       | No books  |             0 | No sales   |
| J8845       | 1541      |            18 | 211.80     |
| J8845       | 1542      |             2 | 33.98      |
| J8845       | All books |            20 | 245.78     |
| K2002       | No books  |             0 | No sales   |
| K2002       | 2006      |            84 | 1733.90    |
| K2002       | 2007      |           106 | 3833.96    |
| K2002       | All books |           190 | 5567.86    |
| K7620       | No books  |             0 | No sales   |
| K7620       | 1425      |           106 | 2973.16    |
| K7620       | 1448      |          1984 | 50882.00   |
| K7620       | 1978      |            50 | 4744.00    |
| K7620       | All books |          2140 | 58599.16   |
| K7845       | No books  |             0 | No sales   |
| K7845       | 1279      |            24 | 944.76     |
| K7845       | All books |            24 | 944.76     |
| L0040       | No books  |             0 | No sales   |
| L0040       | 1128      |          1638 | 63818.68   |
| L0040       | All books |          1638 | 63818.68   |
| L0130       | No books  |             0 | No sales   |
| L0130       | No books  |             0 | No sales   |
| L0140       | No books  |             0 | No sales   |
| L0140       | 1108      |          1884 | 56820.60   |
| L0140       | All books |          1884 | 56820.60   |
| L0245       | No books  |             0 | No sales   |
| L0245       | 1894      |            48 | 1688.96    |
| L0245       | All books |            48 | 1688.96    |
| L0453       | No books  |             0 | No sales   |
| L0453       | 1188      |             2 | 99.98      |
| L0453       | All books |             2 | 99.98      |
| L2444       | No books  |             0 | No sales   |
| L2444       | 1877      |             2 | 90.00      |
| L2444       | All books |             2 | 90.00      |
| L3001       | No books  |             0 | No sales   |
| L3001       | 1401      |          1082 | 59932.00   |
| L3001       | All books |          1082 | 59932.00   |
| M0024       | No books  |             0 | No sales   |
| M0024       | 1609      |             8 | 151.60     |
| M0024       | All books |             8 | 151.60     |
| M0053       | No books  |             0 | No sales   |
| M0053       | 1105      |           160 | 8824.00    |
| M0053       | 1110      |             8 | 400.00     |
| M0053       | 1269      |             6 | 373.46     |
| M0053       | All books |           174 | 9597.46    |
| M0110       | No books  |             0 | No sales   |
| M0110       | 1108      |          1884 | 56820.60   |
| M0110       | All books |          1884 | 56820.60   |
| M0150       | No books  |             0 | No sales   |
| M0150       | 1128      |          1638 | 63818.68   |
| M0150       | All books |          1638 | 63818.68   |
| M0157       | No books  |             0 | No sales   |
| M0157       | 1457      |            20 | 1079.80    |
| M0157       | 1678      |            20 | 999.80     |
| M0157       | All books |            40 | 2079.60    |
| M0295       | No books  |             0 | No sales   |
| M0295       | 1543      |           100 | 2500.00    |
| M0295       | 1544      |           200 | 3552.00    |
| M0295       | All books |           300 | 6052.00    |
| M2475       | No books  |             0 | No sales   |
| M2475       | No books  |             0 | No sales   |
| M3110       | No books  |             0 | No sales   |
| M3110       | No books  |             0 | No sales   |
| M3145       | No books  |             0 | No sales   |
| M3145       | 1626      |             2 | 39.90      |
| M3145       | All books |             2 | 39.90      |
| M3154       | No books  |             0 | No sales   |
| M3154       | No books  |             0 | No sales   |
| M3200       | No books  |             0 | No sales   |
| M3200       | 1546      |            28 | 290.92     |
| M3200       | All books |            28 | 290.92     |
| M4540       | No books  |             0 | No sales   |
| M4540       | No books  |             0 | No sales   |
| N6457       | No books  |             0 | No sales   |
| N6457       | 1835      |             2 | 91.98      |
| N6457       | All books |             2 | 91.98      |
| O0345       | No books  |             0 | No sales   |
| O0345       | No books  |             0 | No sales   |
| O0346       | No books  |             0 | No sales   |
| O0346       | No books  |             0 | No sales   |
| P0500       | No books  |             0 | No sales   |
| P0500       | 1279      |            24 | 944.76     |
| P0500       | All books |            24 | 944.76     |
| P2308       | No books  |             0 | No sales   |
| P2308       | 2002      |            54 | 1910.00    |
| P2308       | All books |            54 | 1910.00    |
| P3002       | No books  |             0 | No sales   |
| P3002       | No books  |             0 | No sales   |
| P6030       | No books  |             0 | No sales   |
| P6030       | 2018      |             4 | 199.96     |
| P6030       | All books |             4 | 199.96     |
| P7477       | No books  |             0 | No sales   |
| P7477       | No books  |             0 | No sales   |
| R0040       | No books  |             0 | No sales   |
| R0040       | 1457      |            20 | 1079.80    |
| R0040       | All books |            20 | 1079.80    |
| R0700       | No books  |             0 | No sales   |
| R0700       | 2025      |          1120 | 43680.00   |
| R0700       | All books |          1120 | 43680.00   |
| R2040       | No books  |             0 | No sales   |
| R2040       | 1102      |             8 | 399.92     |
| R2040       | 1670      |           120 | 4800.00    |
| R2040       | All books |           128 | 5199.92    |
| R5808       | No books  |             0 | No sales   |
| R5808       | 1602      |          1796 | 3893.50    |
| R5808       | All books |          1796 | 3893.50    |
| R5858       | No books  |             0 | No sales   |
| R5858       | 1357      |           108 | 2787.20    |
| R5858       | All books |           108 | 2787.20    |
| S0025       | No books  |             0 | No sales   |
| S0025       | 1104      |           266 | 11970.00   |
| S0025       | All books |           266 | 11970.00   |
| S0205       | No books  |             0 | No sales   |
| S0205       | 2008      |           216 | 9500.90    |
| S0205       | All books |           216 | 9500.90    |
| S0250       | No books  |             0 | No sales   |
| S0250       | No books  |             0 | No sales   |
| S1164       | No books  |             0 | No sales   |
| S1164       | 1180      |            24 | 1113.76    |
| S1164       | All books |            24 | 1113.76    |
| S1900       | No books  |             0 | No sales   |
| S1900       | 1877      |             2 | 90.00      |
| S1900       | All books |             2 | 90.00      |
| S2144       | No books  |             0 | No sales   |
| S2144       | No books  |             0 | No sales   |
| S2145       | No books  |             0 | No sales   |
| S2145       | No books  |             0 | No sales   |
| S2178       | No books  |             0 | No sales   |
| S2178       | 2006      |            84 | 1733.90    |
| S2178       | 2007      |           106 | 3833.96    |
| S2178       | All books |           190 | 5567.86    |
| S2183       | No books  |             0 | No sales   |
| S2183       | 2005      |            40 | 1800.00    |
| S2183       | All books |            40 | 1800.00    |
| S2548       | No books  |             0 | No sales   |
| S2548       | 1677      |             2 | 140.00     |
| S2548       | All books |             2 | 140.00     |
| S2789       | No books  |             0 | No sales   |
| S2789       | 2004      |             2 | 99.90      |
| S2789       | All books |             2 | 99.90      |
| S3110       | No books  |             0 | No sales   |
| S3110       | 1305      |          1796 | 10345.00   |
| S3110       | 1306      |            30 | 7503.60    |
| S3110       | All books |          1826 | 17848.60   |
| T6748       | No books  |             0 | No sales   |
| T6748       | 1877      |             2 | 90.00      |
| T6748       | All books |             2 | 90.00      |
| T6789       | No books  |             0 | No sales   |
| T6789       | 1979      |             2 | 107.98     |
| T6789       | All books |             2 | 107.98     |
| V1144       | No books  |             0 | No sales   |
| V1144       | No books  |             0 | No sales   |
| W0030       | No books  |             0 | No sales   |
| W0030       | 1133      |            36 | 664.20     |
| W0030       | All books |            36 | 664.20     |
| W0060       | No books  |             0 | No sales   |
| W0060       | 1109      |           106 | 3681.60    |
| W0060       | All books |           106 | 3681.60    |
| W0078       | No books  |             0 | No sales   |
| W0078       | 1258      |            12 | 543.88     |
| W0078       | All books |            12 | 543.88     |
| W2388       | No books  |             0 | No sales   |
| W2388       | 1677      |             2 | 140.00     |
| W2388       | All books |             2 | 140.00     |
| W3145       | No books  |             0 | No sales   |
| W3145       | 1627      |            10 | 1361.34    |
| W3145       | 1628      |            42 | 1381.10    |
| W3145       | 1629      |           108 | 2154.60    |
| W3145       | All books |           160 | 4897.04    |
| W3433       | No books  |             0 | No sales   |
| W3433       | 1619      |           220 | 5995.76    |
| W3433       | All books |           220 | 5995.76    |
| W4512       | No books  |             0 | No sales   |
| W4512       | No books  |             0 | No sales   |
| W5145       | No books  |             0 | No sales   |
| W5145       | 1625      |             2 | 8.00       |
| W5145       | All books |             2 | 8.00       |
| Z0878       | No books  |             0 | No sales   |
| Z0878       | 1877      |             2 | 90.00      |
| Z0878       | All books |             2 | 90.00      |
| Z0897       | No books  |             0 | No sales   |
| Z0897       | 1877      |             2 | 90.00      |
| Z0897       | All books |             2 | 90.00      |
| Grand Total | All books |         29126 | 949127.44  |
+-------------+-----------+---------------+------------+
314 rows in set (0.05 sec)

--------------
/*  TASK 06 */

select book_id, page_count
,
	(
		select 
			count(distinct floor(page_count/50)*50)
		from a_bkinfo.books B1
		where floor(B1.page_count/50)*(50) >= floor(B2.page_count/50)*(50)
	) as Ranking
from a_bkinfo.books B2
where page_count is not null
order by page_count desc
--------------

+---------+------------+---------+
| book_id | page_count | Ranking |
+---------+------------+---------+
|    1448 |       3192 |       1 |
|    1306 |       2895 |       2 |
|    1979 |       1368 |       3 |
|    1678 |       1002 |       4 |
|    1677 |        982 |       5 |
|    1689 |        980 |       5 |
|    1401 |        976 |       5 |
|    2622 |        956 |       5 |
|    1545 |        944 |       6 |
|    1182 |        918 |       6 |
|    2005 |        894 |       7 |
|    1142 |        879 |       7 |
|    1269 |        848 |       8 |
|    1623 |        828 |       8 |
|    1161 |        780 |       9 |
|    2031 |        750 |       9 |
|    1627 |        732 |      10 |
|    1877 |        708 |      10 |
|    1108 |        680 |      11 |
|    2001 |        675 |      11 |
|    1184 |        650 |      11 |
|    2018 |        650 |      11 |
|    1109 |        650 |      11 |
|    1835 |        634 |      12 |
|    1670 |        608 |      12 |
|    1104 |        604 |      12 |
|    1185 |        595 |      13 |
|    2025 |        572 |      13 |
|    1894 |        548 |      14 |
|    1628 |        544 |      14 |
|    1175 |        538 |      14 |
|    2017 |        528 |      14 |
|    1110 |        520 |      14 |
|    2008 |        503 |      14 |
|    2623 |        501 |      14 |
|    1258 |        500 |      14 |
|    1776 |        500 |      14 |
|    1245 |        488 |      15 |
|    1200 |        488 |      15 |
|    1425 |        468 |      15 |
|    2027 |        464 |      15 |
|    2028 |        464 |      15 |
|    1105 |        450 |      15 |
|    1541 |        448 |      16 |
|    1234 |        416 |      16 |
|    1278 |        408 |      16 |
|    2002 |        402 |      16 |
|    2003 |        402 |      16 |
|    1077 |        401 |      16 |
|    1180 |        400 |      16 |
|    2004 |        399 |      17 |
|    2007 |        391 |      17 |
|    2006 |        390 |      17 |
|    1609 |        376 |      17 |
|    1478 |        368 |      17 |
|    1978 |        360 |      17 |
|    1630 |        352 |      17 |
|    1162 |        350 |      17 |
|    1948 |        346 |      18 |
|    1544 |        336 |      18 |
|    1279 |        336 |      18 |
|    1543 |        327 |      18 |
|    1107 |        325 |      18 |
|    1546 |        304 |      18 |
|    1621 |        304 |      18 |
|    1457 |        300 |      18 |
|    1304 |        300 |      18 |
|    1101 |        300 |      18 |
|    1774 |        288 |      19 |
|    1626 |        280 |      19 |
|    1128 |        275 |      19 |
|    1622 |        265 |      19 |
|    1542 |        256 |      19 |
|    1102 |        250 |      19 |
|    2032 |        250 |      19 |
|    1106 |        250 |      19 |
|    1357 |        240 |      20 |
|    1525 |        213 |      20 |
|    1629 |        160 |      21 |
|    1619 |        158 |      21 |
|    2009 |        150 |      21 |
|    1133 |        125 |      22 |
|    1103 |        125 |      22 |
|    1483 |        125 |      22 |
|    1188 |        105 |      22 |
|    1305 |        100 |      22 |
|    1199 |         98 |      23 |
|    1537 |         68 |      23 |
|    1602 |         68 |      23 |
|    1625 |         64 |      23 |
|    1624 |          9 |      24 |
|    2029 |          5 |      24 |
|    1301 |          0 |      24 |
+---------+------------+---------+
93 rows in set (0.08 sec)

--------------
/*  TASK 07 */

set @september = '2013-09-01'
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
set @september_end = '2013-09-30'
--------------

Query OK, 0 rows affected (0.00 sec)

--------------
select days
	, coalesce(sum(quantity), 0) as TotalQuantity
	, coalesce(sum(quantity * order_price),0.0) as TotalSales
from 
(
	select days, sales_data.quantity, sales_data.order_date, sales_data.order_price
	from 
		(
		select date_add(@september, interval (b1.val + b2.val + b4.val + b8.val + b16.val) day) as 'days'
		from
			( select 0 val union all select 1) b1 
			cross join
			( select 0 val union all select 2) b2 
			cross join
			( select 0 val union all select 4) b4 
			cross join
			( select 0 val union all select 8) b8 
			cross join
			( select 0 val union all select 16) b16 
		)tbl_days
		left join 
		(
			select order_date, order_id, quantity, order_price
			from a_bkorders.order_details OD
			join a_bkorders.order_headers OH using(order_id)
		)sales_data on tbl_days.days = sales_data.order_date  	
		where days between @september and @september_end
)tbl_data
group by days
--------------

+------------+---------------+------------+
| days       | TotalQuantity | TotalSales |
+------------+---------------+------------+
| 2013-09-01 |            11 |     165.00 |
| 2013-09-02 |            45 |    2107.45 |
| 2013-09-03 |            50 |    1250.00 |
| 2013-09-04 |           100 |    2749.50 |
| 2013-09-05 |             6 |     124.95 |
| 2013-09-06 |            10 |    1475.60 |
| 2013-09-07 |             0 |       0.00 |
| 2013-09-08 |            28 |     806.00 |
| 2013-09-09 |             0 |       0.00 |
| 2013-09-10 |           154 |    4308.40 |
| 2013-09-11 |             0 |       0.00 |
| 2013-09-12 |             0 |       0.00 |
| 2013-09-13 |             0 |       0.00 |
| 2013-09-14 |            18 |     525.40 |
| 2013-09-15 |           102 |     297.19 |
| 2013-09-16 |             0 |       0.00 |
| 2013-09-17 |             0 |       0.00 |
| 2013-09-18 |            48 |    1455.24 |
| 2013-09-19 |             0 |       0.00 |
| 2013-09-20 |            25 |     996.68 |
| 2013-09-21 |             0 |       0.00 |
| 2013-09-22 |            88 |    2726.29 |
| 2013-09-23 |             2 |      59.99 |
| 2013-09-24 |             1 |      45.00 |
| 2013-09-25 |            15 |     649.95 |
| 2013-09-26 |             0 |       0.00 |
| 2013-09-27 |             0 |       0.00 |
| 2013-09-28 |           578 |   22220.38 |
| 2013-09-29 |           100 |    2500.00 |
| 2013-09-30 |           114 |    3325.26 |
+------------+---------------+------------+
30 rows in set (0.01 sec)

--------------
/*  TASK 08 */

/*  TASK 09 */

/*  TASK 10 */
--------------

Query OK, 0 rows affected (0.00 sec)

Bye
